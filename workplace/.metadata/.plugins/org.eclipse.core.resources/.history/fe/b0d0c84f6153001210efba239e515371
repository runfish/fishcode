package net.dfrz.smmgr01.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.util.List;
import net.dfrz.smmgr01.domain.Category;
import net.dfrz.smmgr01.exception.DataAccessException;
import net.dfrz.smmgr01.utils.DBUtils;

public class CategoryDaoJDBCImpl implements CategoryDao {

	private static final String ADD_CTG="insert into category values(seq_ctgId.nextval,?)";
	private static final String DELETE_CTG="delete from category where ctg_id=?";
	private static final String LOAD_ALL="select * from category order by ctg_id desc";
	private static final String UPDATE_CTG="update category set ctg_name=? where ctg_id=?";
	public void add(Category ctg) {
		// TODO Auto-generated method stub
		Connection conn =DBUtils.getConn();
		PreparedStatement pstmt=null;
		try {
			pstmt=conn.prepareStatement(ADD_CTG);
			pstmt.setString(1, ctg.getCtgName());
			pstmt.executeUpdate();
			
		} catch (SQLException e) {
			// TODO: handle exception
			e.printStackTrace();
			String detailMsg=null;
			if(e.getMessage().indexOf("ORA-00001")!=-1) 
				detailMsg="类别名称出现了雷同!";
			throw new DataAccessException("类别信息保存失败,"+detailMsg);
		}finally{
			DBUtils.getInstance().ReleaseRes(conn, pstmt, null);
		}

	}

	public void delete(Category ctg) {
		// TODO Auto-generated method stub

	}

	public void getGoodsById(int ctgId) {
		// TODO Auto-generated method stub

	}

	public List loadAll() {
		// TODO Auto-generated method stub
		return null;
	}

	public void update(Category ctg) {
		// TODO Auto-generated method stub

	}

}
